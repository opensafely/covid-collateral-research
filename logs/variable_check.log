
. foreach period in pre pandemic wave1 easing1 wave2 easing2 wave3 easing3 {
  2. use ./output/prep_survival_`period', clear
  3. di "`period'""
  4. * Display missing STP
. di "Missing STP"
  5. count if stp==""
  6. * Check variables
. sum age
  7. * Check all those with IMD has hsoa
. tab has_msoa imd
  8. * Check comorbidities
. foreach var in has_t1_diabetes has_t2_diabetes cvd_subgroup has_asthma has_co
> pd resp_subgroup mh_subgroup {
  9.     tab `var', m
 10.     }
 11. }
pre
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000      39.504    23.38831          0         99

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         3          7          7         10          9 |        50 
         1 |        50        185        170        190        172 |       950 
-----------+-------------------------------------------------------+----------
     Total |        53        192        177        200        181 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |        14 |        50 
         1 |       183 |       950 
-----------+-----------+----------
     Total |       197 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
pandemic
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000      39.451    22.94206          0         97

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         3          4         11          7          9 |        50 
         1 |        47        198        180        175        181 |       950 
-----------+-------------------------------------------------------+----------
     Total |        50        202        191        182        190 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |        16 |        50 
         1 |       169 |       950 
-----------+-----------+----------
     Total |       185 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
wave1
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000      39.845    24.16727          0         97

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         4         11          8          9         10 |        50 
         1 |        46        174        164        190        194 |       950 
-----------+-------------------------------------------------------+----------
     Total |        50        185        172        199        204 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |         8 |        50 
         1 |       182 |       950 
-----------+-----------+----------
     Total |       190 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
easing1
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000      40.304    23.60926          0         98

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         4         14         11          9          6 |        50 
         1 |        42        190        182        184        170 |       950 
-----------+-------------------------------------------------------+----------
     Total |        46        204        193        193        176 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |         6 |        50 
         1 |       182 |       950 
-----------+-----------+----------
     Total |       188 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
wave2
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000       39.13    23.94942          0        106

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         3          9         10          7         12 |        50 
         1 |        63        167        170        196        171 |       950 
-----------+-------------------------------------------------------+----------
     Total |        66        176        180        203        183 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |         9 |        50 
         1 |       183 |       950 
-----------+-----------+----------
     Total |       192 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
easing2
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000       41.45    23.17072          0         97

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         1         11          8          6         13 |        50 
         1 |        31        187        181        183        180 |       950 
-----------+-------------------------------------------------------+----------
     Total |        32        198        189        189        193 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |        11 |        50 
         1 |       188 |       950 
-----------+-----------+----------
     Total |       199 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
wave3
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000      40.593    23.30254          0        105

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         3          8         11         10         13 |        50 
         1 |        61        175        183        171        192 |       950 
-----------+-------------------------------------------------------+----------
     Total |        64        183        194        181        205 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |         5 |        50 
         1 |       168 |       950 
-----------+-----------+----------
     Total |       173 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00
easing3
Missing STP
  950

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,000       41.07    24.01516          0        105

           |                          imd
  has_msoa |         0          1          2          3          4 |     Total
-----------+-------------------------------------------------------+----------
         0 |         0         10          8         11         11 |        50 
         1 |        50        169        187        196        182 |       950 
-----------+-------------------------------------------------------+----------
     Total |        50        179        195        207        193 |     1,000 


           |    imd
  has_msoa |         5 |     Total
-----------+-----------+----------
         0 |        10 |        50 
         1 |       166 |       950 
-----------+-----------+----------
     Total |       176 |     1,000 

has_t1_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

has_t2_diab |
       etes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        199       19.90       19.90
          1 |        801       80.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00

cvd_subgrou |
          p |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

 has_asthma |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

   has_copd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

resp_subgro |
         up |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        950       95.00       95.00
          1 |         50        5.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

mh_subgroup |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        800       80.00       80.00
          1 |        200       20.00      100.00
------------+-----------------------------------
      Total |      1,000      100.00

. 
. /* Check files from 2018
> import delimited "./output/measures/cvd/input_2018-03-01.csv", clear
> misstable summarize imd 
> count if sex==""
> 
> import delimited "./output/measures/mh/input_mh_2018-03-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> * check files from 2019
> import delimited "./output/measures/cvd/input_2019-05-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> import delimited "./output/measures/mh/input_mh_2019-05-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> * check files from 2020
> import delimited "./output/measures/cvd/input_2020-06-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> import delimited "./output/measures/mh/input_mh_2020-06-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> * check files from 2021
> import delimited "./output/measures/cvd/input_2021-07-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> import delimited "./output/measures/mh/input_mh_2021-07-01.csv", clear
> misstable summarize imd
> count if sex==""
> 
> * Checking files created with the 2020 static cohort
> * Check files from 2018
> import delimited "./output/measures/cvd/test/input_2018-03-01.csv", clear
> misstable summarize age imd
> count if sex==""
> count if region==""
>         
> import delimited "./output/measures/cvd/test/input_2020-03-01.csv", clear
> misstable summarize age imd
> count if sex==""
> count if region==""
> */
. 
. /* Checking dates survival analysis
> foreach period in pre pandemic wave1 easing1 wave2 easing2 wave3 easing3 {
>     use ./output/prep_survival_`period', clear
>     list anx_admit_date in 1/5 if anx_admit_date!=.
>     gen anx_admit=(anx_admit_date!=.)
>     tab anx_admit
> 
>     count if anx_admit_date < index_date
>     count if end_date < index_date
> 
>     gen anx_end = end_date
>     replace anx_end = anx_admit_date if anx_admit==1
> }*/
. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/variable_check.log
  log type:  text
 closed on:  14 Jul 2022, 15:41:15
-------------------------------------------------------------------------------
