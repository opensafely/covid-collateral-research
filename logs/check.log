
. 
. * Import each spreadhseet and create graph
. foreach v in primary any emergency {
  2.     * Ethnicity
.     clear 
  3.     import delimited using ./output/measures/measure_dm_`v'_ethnicity_rate
> .csv
  4.     * Generate rate per 100,000
.     gen rate = value*100000 
  5.     * Format date
.     gen dateA = date(date, "YMD")
  6.     drop date
  7.     format dateA %dD/M/Y
  8.     tab dateA 
  9.     * reshape dataset so columns with rates for each ethnicity 
.     reshape wide value rate population dm_admission_`v', i(dateA) j(ethnicity
> )
 10.     describe
 11.     * Labelling ethnicity variables
.     label var rate1 "Ethnicity - White"
 12.     label var rate2 "Ethnicity - Mixed"
 13.     label var rate3 "Ethnicity - Asian"
 14.     label var rate4 "Ethnicity - Black"
 15.     label var rate5 "Ethnicity - Other"
 16. 
.     * Generate line graph
.     graph twoway line rate1 rate2 rate3 rate4 rate5 date, xlabel(, angle(45) 
> format(%dM-CY)) ///
>     ytitle("Rate per 100,000") 
 17. 
.     graph export ./output/line_ethnic_dm_`v'.eps, as(eps) replace
 18.     * IMD
.     clear 
 19.     import delimited using ./output/measures/measure_dm_`v'_imd_rate.csv
 20.     * Generate rate per 100,000
.     gen rate = value*100000 
 21.     * Format date
.     gen dateA = date(date, "YMD")
 22.     drop date
 23.     format dateA %dD/M/Y
 24.     tab dateA 
 25.     * reshape dataset so columns with rates for each ethnicity 
.     reshape wide value rate population dm_admission_`v', i(dateA) j(imd)
 26.     describe
 27.     * Labelling ethnicity variables
.     label var rate1 "IMD - 1"
 28.     label var rate2 "IMD - 2"
 29.     label var rate3 "IMD - 3"
 30.     label var rate4 "IMD - 4"
 31.     label var rate5 "IMD - 5"
 32. 
.     * Generate line graph
.     graph twoway line rate1 rate2 rate3 rate4 rate5 date, xlabel(, format(%dM
> -CY)) ///
>     ytitle("Rate per 100,000") 
 33. 
.     graph export ./output/line_imd_dm_`v'.eps, as(eps) replace
 34. 
. }
(5 vars, 20 obs)

      dateA |      Freq.     Percent        Cum.
------------+-----------------------------------
  01mar2020 |          5       25.00       25.00
  01apr2020 |          5       25.00       50.00
  01may2020 |          5       25.00       75.00
  01jun2020 |          5       25.00      100.00
------------+-----------------------------------
      Total |         20      100.00
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       20   ->       4
Number of variables                   6   ->      21
j variable (5 values)         ethnicity   ->   (dropped)
xij variables:
                                  value   ->   value1 value2 ... value5
                                   rate   ->   rate1 rate2 ... rate5
                             population   ->   population1 population2 ... popu
> lation5
                   dm_admission_primary   ->   dm_admission_primary1 dm_admissi
> on_primary2 ... dm_admission_primary5
-----------------------------------------------------------------------------

Contains data
  obs:             4                          
 vars:            21                          
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
dateA           float   %dD/M/Y               
dm_admission_~1 byte    %8.0g                 1 dm_admission_primary
population1     int     %8.0g                 1 population
value1          float   %9.0g                 1 value
rate1           float   %9.0g                 1 rate
dm_admission_~2 byte    %8.0g                 2 dm_admission_primary
population2     int     %8.0g                 2 population
value2          float   %9.0g                 2 value
rate2           float   %9.0g                 2 rate
dm_admission_~3 byte    %8.0g                 3 dm_admission_primary
population3     int     %8.0g                 3 population
value3          float   %9.0g                 3 value
rate3           float   %9.0g                 3 rate
dm_admission_~4 byte    %8.0g                 4 dm_admission_primary
population4     int     %8.0g                 4 population
value4          float   %9.0g                 4 value
rate4           float   %9.0g                 4 rate
dm_admission_~5 byte    %8.0g                 5 dm_admission_primary
population5     int     %8.0g                 5 population
value5          float   %9.0g                 5 value
rate5           float   %9.0g                 5 rate
-------------------------------------------------------------------------------
Sorted by: dateA
(note: file ./output/line_ethnic_dm_primary.eps not found)
(file ./output/line_ethnic_dm_primary.eps written in EPS format)
(5 vars, 24 obs)

      dateA |      Freq.     Percent        Cum.
------------+-----------------------------------
  01mar2020 |          6       25.00       25.00
  01apr2020 |          6       25.00       50.00
  01may2020 |          6       25.00       75.00
  01jun2020 |          6       25.00      100.00
------------+-----------------------------------
      Total |         24      100.00
(note: j = 0 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->       4
Number of variables                   6   ->      25
j variable (6 values)               imd   ->   (dropped)
xij variables:
                                  value   ->   value0 value1 ... value5
                                   rate   ->   rate0 rate1 ... rate5
                             population   ->   population0 population1 ... popu
> lation5
                   dm_admission_primary   ->   dm_admission_primary0 dm_admissi
> on_primary1 ... dm_admission_primary5
-----------------------------------------------------------------------------

Contains data
  obs:             4                          
 vars:            25                          
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
dateA           float   %dD/M/Y               
dm_admission_~0 byte    %8.0g                 0 dm_admission_primary
population0     int     %8.0g                 0 population
value0          float   %9.0g                 0 value
rate0           float   %9.0g                 0 rate
dm_admission_~1 byte    %8.0g                 1 dm_admission_primary
population1     int     %8.0g                 1 population
value1          float   %9.0g                 1 value
rate1           float   %9.0g                 1 rate
dm_admission_~2 byte    %8.0g                 2 dm_admission_primary
population2     int     %8.0g                 2 population
value2          float   %9.0g                 2 value
rate2           float   %9.0g                 2 rate
dm_admission_~3 byte    %8.0g                 3 dm_admission_primary
population3     int     %8.0g                 3 population
value3          float   %9.0g                 3 value
rate3           float   %9.0g                 3 rate
dm_admission_~4 byte    %8.0g                 4 dm_admission_primary
population4     int     %8.0g                 4 population
value4          float   %9.0g                 4 value
rate4           float   %9.0g                 4 rate
dm_admission_~5 byte    %8.0g                 5 dm_admission_primary
population5     int     %8.0g                 5 population
value5          float   %9.0g                 5 value
rate5           float   %9.0g                 5 rate
-------------------------------------------------------------------------------
Sorted by: dateA
(note: file ./output/line_imd_dm_primary.eps not found)
(file ./output/line_imd_dm_primary.eps written in EPS format)
(5 vars, 20 obs)

      dateA |      Freq.     Percent        Cum.
------------+-----------------------------------
  01mar2020 |          5       25.00       25.00
  01apr2020 |          5       25.00       50.00
  01may2020 |          5       25.00       75.00
  01jun2020 |          5       25.00      100.00
------------+-----------------------------------
      Total |         20      100.00
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       20   ->       4
Number of variables                   6   ->      21
j variable (5 values)         ethnicity   ->   (dropped)
xij variables:
                                  value   ->   value1 value2 ... value5
                                   rate   ->   rate1 rate2 ... rate5
                             population   ->   population1 population2 ... popu
> lation5
                       dm_admission_any   ->   dm_admission_any1 dm_admission_a
> ny2 ... dm_admission_any5
-----------------------------------------------------------------------------

Contains data
  obs:             4                          
 vars:            21                          
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
dateA           float   %dD/M/Y               
dm_admission_~1 byte    %8.0g                 1 dm_admission_any
population1     int     %8.0g                 1 population
value1          float   %9.0g                 1 value
rate1           float   %9.0g                 1 rate
dm_admission_~2 byte    %8.0g                 2 dm_admission_any
population2     int     %8.0g                 2 population
value2          float   %9.0g                 2 value
rate2           float   %9.0g                 2 rate
dm_admission_~3 byte    %8.0g                 3 dm_admission_any
population3     int     %8.0g                 3 population
value3          float   %9.0g                 3 value
rate3           float   %9.0g                 3 rate
dm_admission_~4 byte    %8.0g                 4 dm_admission_any
population4     int     %8.0g                 4 population
value4          float   %9.0g                 4 value
rate4           float   %9.0g                 4 rate
dm_admission_~5 byte    %8.0g                 5 dm_admission_any
population5     int     %8.0g                 5 population
value5          float   %9.0g                 5 value
rate5           float   %9.0g                 5 rate
-------------------------------------------------------------------------------
Sorted by: dateA
(note: file ./output/line_ethnic_dm_any.eps not found)
(file ./output/line_ethnic_dm_any.eps written in EPS format)
(5 vars, 24 obs)

      dateA |      Freq.     Percent        Cum.
------------+-----------------------------------
  01mar2020 |          6       25.00       25.00
  01apr2020 |          6       25.00       50.00
  01may2020 |          6       25.00       75.00
  01jun2020 |          6       25.00      100.00
------------+-----------------------------------
      Total |         24      100.00
(note: j = 0 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->       4
Number of variables                   6   ->      25
j variable (6 values)               imd   ->   (dropped)
xij variables:
                                  value   ->   value0 value1 ... value5
                                   rate   ->   rate0 rate1 ... rate5
                             population   ->   population0 population1 ... popu
> lation5
                       dm_admission_any   ->   dm_admission_any0 dm_admission_a
> ny1 ... dm_admission_any5
-----------------------------------------------------------------------------

Contains data
  obs:             4                          
 vars:            25                          
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
dateA           float   %dD/M/Y               
dm_admission_~0 byte    %8.0g                 0 dm_admission_any
population0     int     %8.0g                 0 population
value0          float   %9.0g                 0 value
rate0           float   %9.0g                 0 rate
dm_admission_~1 byte    %8.0g                 1 dm_admission_any
population1     int     %8.0g                 1 population
value1          float   %9.0g                 1 value
rate1           float   %9.0g                 1 rate
dm_admission_~2 byte    %8.0g                 2 dm_admission_any
population2     int     %8.0g                 2 population
value2          float   %9.0g                 2 value
rate2           float   %9.0g                 2 rate
dm_admission_~3 byte    %8.0g                 3 dm_admission_any
population3     int     %8.0g                 3 population
value3          float   %9.0g                 3 value
rate3           float   %9.0g                 3 rate
dm_admission_~4 byte    %8.0g                 4 dm_admission_any
population4     int     %8.0g                 4 population
value4          float   %9.0g                 4 value
rate4           float   %9.0g                 4 rate
dm_admission_~5 byte    %8.0g                 5 dm_admission_any
population5     int     %8.0g                 5 population
value5          float   %9.0g                 5 value
rate5           float   %9.0g                 5 rate
-------------------------------------------------------------------------------
Sorted by: dateA
(note: file ./output/line_imd_dm_any.eps not found)
(file ./output/line_imd_dm_any.eps written in EPS format)
(5 vars, 20 obs)

      dateA |      Freq.     Percent        Cum.
------------+-----------------------------------
  01mar2020 |          5       25.00       25.00
  01apr2020 |          5       25.00       50.00
  01may2020 |          5       25.00       75.00
  01jun2020 |          5       25.00      100.00
------------+-----------------------------------
      Total |         20      100.00
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       20   ->       4
Number of variables                   6   ->      21
j variable (5 values)         ethnicity   ->   (dropped)
xij variables:
                                  value   ->   value1 value2 ... value5
                                   rate   ->   rate1 rate2 ... rate5
                             population   ->   population1 population2 ... popu
> lation5
                 dm_admission_emergency   ->   dm_admission_emergency1 dm_admis
> sion_emergency2 ... dm_admission_emergency5
-----------------------------------------------------------------------------

Contains data
  obs:             4                          
 vars:            21                          
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
dateA           float   %dD/M/Y               
dm_admission_~1 byte    %8.0g                 1 dm_admission_emergency
population1     int     %8.0g                 1 population
value1          float   %9.0g                 1 value
rate1           float   %9.0g                 1 rate
dm_admission_~2 byte    %8.0g                 2 dm_admission_emergency
population2     int     %8.0g                 2 population
value2          float   %9.0g                 2 value
rate2           float   %9.0g                 2 rate
dm_admission_~3 byte    %8.0g                 3 dm_admission_emergency
population3     int     %8.0g                 3 population
value3          float   %9.0g                 3 value
rate3           float   %9.0g                 3 rate
dm_admission_~4 byte    %8.0g                 4 dm_admission_emergency
population4     int     %8.0g                 4 population
value4          float   %9.0g                 4 value
rate4           float   %9.0g                 4 rate
dm_admission_~5 byte    %8.0g                 5 dm_admission_emergency
population5     int     %8.0g                 5 population
value5          float   %9.0g                 5 value
rate5           float   %9.0g                 5 rate
-------------------------------------------------------------------------------
Sorted by: dateA
(note: file ./output/line_ethnic_dm_emergency.eps not found)
(file ./output/line_ethnic_dm_emergency.eps written in EPS format)
(5 vars, 24 obs)

      dateA |      Freq.     Percent        Cum.
------------+-----------------------------------
  01mar2020 |          6       25.00       25.00
  01apr2020 |          6       25.00       50.00
  01may2020 |          6       25.00       75.00
  01jun2020 |          6       25.00      100.00
------------+-----------------------------------
      Total |         24      100.00
(note: j = 0 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->       4
Number of variables                   6   ->      25
j variable (6 values)               imd   ->   (dropped)
xij variables:
                                  value   ->   value0 value1 ... value5
                                   rate   ->   rate0 rate1 ... rate5
                             population   ->   population0 population1 ... popu
> lation5
                 dm_admission_emergency   ->   dm_admission_emergency0 dm_admis
> sion_emergency1 ... dm_admission_emergency5
-----------------------------------------------------------------------------

Contains data
  obs:             4                          
 vars:            25                          
-------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
dateA           float   %dD/M/Y               
dm_admission_~0 byte    %8.0g                 0 dm_admission_emergency
population0     int     %8.0g                 0 population
value0          float   %9.0g                 0 value
rate0           float   %9.0g                 0 rate
dm_admission_~1 byte    %8.0g                 1 dm_admission_emergency
population1     int     %8.0g                 1 population
value1          float   %9.0g                 1 value
rate1           float   %9.0g                 1 rate
dm_admission_~2 byte    %8.0g                 2 dm_admission_emergency
population2     int     %8.0g                 2 population
value2          float   %9.0g                 2 value
rate2           float   %9.0g                 2 rate
dm_admission_~3 byte    %8.0g                 3 dm_admission_emergency
population3     int     %8.0g                 3 population
value3          float   %9.0g                 3 value
rate3           float   %9.0g                 3 rate
dm_admission_~4 byte    %8.0g                 4 dm_admission_emergency
population4     int     %8.0g                 4 population
value4          float   %9.0g                 4 value
rate4           float   %9.0g                 4 rate
dm_admission_~5 byte    %8.0g                 5 dm_admission_emergency
population5     int     %8.0g                 5 population
value5          float   %9.0g                 5 value
rate5           float   %9.0g                 5 rate
-------------------------------------------------------------------------------
Sorted by: dateA
(note: file ./output/line_imd_dm_emergency.eps not found)
(file ./output/line_imd_dm_emergency.eps written in EPS format)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/check.log
  log type:  text
 closed on:   7 Mar 2022, 15:21:30
-------------------------------------------------------------------------------
