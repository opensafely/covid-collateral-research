
. cap mkdir ./output/graphs

. cap mkdir ./output/tempdata

. cap mkdir ./output/tables

. 
. * open file to write results to
. file open tablecontent using ./output/tables/`outcome'_cox_models.txt, write 
> text replace
(note: file ./output/tables/dm_cox_models.txt not found)

. file write tablecontent ("period") _tab ("ethnic_group") _tab ("denominator")
>  _tab ("events") _tab ("total_person_wks") _tab ("Rate") _tab ("unadj_hr") _t
> ab ///
> ("unadj_ci") _tab ("unadj_lci") _tab ("unadj_uci") _tab ("p_adj_hr") _tab ("p
> _adj_ci") _tab ("p_adj_lci") _tab ("p_adj_uci") _tab ("f_adj_hr") _tab ("f_ad
> j_ci") _tab ("f_adj_lci") _tab ("f_adj_uci") _tab  _n

. 
. foreach period in pre pandemic wave1 easing1 wave2 easing2 wave3 easing3 {
  2. use ./output/prep_survival_`period', clear
  3. 
.     * Drop events that occur on index date
.     drop if `outcome'_admit_date==index_date
  4.     * Cox model for each outcome category
.     * Generate flags and end dates for each outcome
.     gen `outcome'_admit=(`outcome'_admit_date!=.)
  5.     tab `outcome'_admit
  6.     count if `outcome'_admit_date!=.
  7.     if r(N) > 10 {
  8.         gen `outcome'_end = end_date
  9.         replace `outcome'_end = `outcome'_admit_date if `outcome'_admit==1
 10. 
.         stset `outcome'_end, fail(`outcome'_admit) id(patient_id) enter(index
> _date) origin(index_date) 
 11.         * Kaplan-Meier plot
.         sts graph, by(eth5) ylabel(.75(.05)1)
 12.         graph export ./output/graphs/km_`outcome'_`period'_eth.svg, as(svg
> ) replace
 13.         * Cox model - crude
.         stcox i.eth5, strata(stp)
 14.         estimates save "./output/tempdata/crude_`outcome'_eth", replace 
 15.         eststo model1
 16.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_crude_`outcome'_eth", replace) idstr("crude_`outcome'_eth") 
 17.         *estat phtest, detail
.         * Cox model - age and gender adjusted
.         stcox i.eth5 i.age_cat i.male, strata(stp)
 18.         estimates save "./output/tempdata/model1_`outcome'_eth", replace 
 19.         eststo model2
 20.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_model1_`outcome'_eth", replace) idstr("model1_`outcome'_eth") 
 21.         *estat phtest, detail
.         * Cox model - fully adjusted
.         stcox i.eth5 i.age_cat i.male i.urban_rural_bin i.imd i.shielded, str
> ata(stp)
 22.         estimates save "./output/tempdata/model2_`outcome'_eth", replace 
 23.         eststo model3
 24.         parmest, label eform format(estimate p lb ub) saving("./output/tem
> pdata/surv_model2_`outcome'_eth", replace) idstr("model2_`outcome'_eth") 
 25.         *estat phtest, detail
.         esttab model1 model2 model3 using "./output/tables/`outcome'_estout_t
> able_eth_`period'.txt", b(a2) ci(2) label wide compress eform ///
>         title ("`outcome'") ///
>         varlabels(`e(labels)') ///
>         stats(N_outcome) ///
>         append 
 26.         eststo clear
 27.     * Write results to table
.         * eth16 labelled columns
. 
.         local lab1: label eth5 1
 28.         local lab2: label eth5 2
 29.         local lab3: label eth5 3
 30.         local lab4: label eth5 4
 31.         local lab5: label eth5 5
 32.         /* counts */
.         
.         * First row, eth16 = 1 (White British) reference cat
.         qui safecount if eth5==1
 33.         local denominator = r(N)
 34.         qui safecount if eth5 == 1 & `outcome'_admit == 1
 35.         local event = r(N)
 36.         bysort eth5: egen total_follow_up = total(_t)
 37.         qui su total_follow_up if eth5 == 1
 38.         local person_week = r(mean)/7
 39.         local rate = 100000*(`event'/`person_week')
 40.         if `event'>10 & `event'!=. {
 41.             file write tablecontent  ("`period'") _tab ("`lab1'") _tab (`d
> enominator') _tab (`event') _tab %10.0f (`person_week') _tab %3.2f (`rate') _
> tab
 42.             file write tablecontent ("1.00") _tab _tab ("1.00") _tab _tab 
> _tab _tab ("1.00") _n
 43.             }
 44.         else {
 45.             file write tablecontent ("`period'") _tab ("`lab`eth''") _tab 
> ("redact") _n
 46.             continue
 47.         }
 48.     * outcomesequent ethnic groups
.         forvalues eth=2/5 {
 49.             qui safecount if eth5==`eth'
 50.             local denominator = r(N)
 51.             qui safecount if eth5 == `eth' & `outcome'_admit == 1
 52.             local event = r(N)
 53.             qui su total_follow_up if eth5 == `eth'
 54.             local person_week = r(mean)/7
 55.             local rate = 100000*(`event'/`person_week')
 56.             if `event'>10 & `event'!=. {
 57.                 file write tablecontent ("`period'") _tab ("`lab`eth''") _
> tab (`denominator') _tab (`event') _tab %10.0f (`person_week') _tab %3.2f (`r
> ate') _tab  
 58.                 cap estimates use "./output/tempdata/crude_`outcome'_eth" 
 59.                 cap lincom `eth'.eth5, eform
 60.                 file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4
> .2f (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub))
>  _tab
 61.                 cap estimates clear
 62.                 cap estimates use "./output/tempdata/model1_`outcome'_eth"
>  
 63.                 cap lincom `eth'.eth5, eform
 64.                 file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4
> .2f (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub))
>   _tab
 65.                 cap estimates clear
 66.                 cap estimates use "./output/tempdata/model2_`outcome'_eth"
>  
 67.                 cap lincom `eth'.eth5, eform
 68.                 file write tablecontent  %4.2f (r(estimate)) _tab ("(") %4
> .2f (r(lb)) (" - ") %4.2f (r(ub)) (")") _tab %4.2f (r(lb)) _tab %4.2f (r(ub))
>  _n
 69.                 cap estimates clear
 70.             }
 71.             else {
 72.                 file write tablecontent ("`period'") _tab ("`lab`eth''") _
> tab ("redact") _n
 73.                 continue
 74.             }
 75.         }  //end ethnic group
 76. drop total_follow_up
 77.     }
 78. else { 
 79.     file write tablecontent ("`period'") _tab ("redact") _n
 80.     continue
 81. }
 82. } //end outcomes
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        932       93.20       93.20
          1 |         68        6.80      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  68
(68 real changes made)

                id:  patient_id
     failure event:  dm_admit != 0 & dm_admit < .
obs. time interval:  (dm_end[_n-1], dm_end]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,000  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,000  observations remaining, representing
      1,000  subjects
         68  failures in single-failure-per-subject data
    725,652  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       752

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_dm_pre_eth.svg not found)
(file ./output/graphs/km_dm_pre_eth.svg written in SVG format)

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -5.4161004
Iteration 1:   log likelihood =  -3.729841
Iteration 2:   log likelihood = -3.5132713
Iteration 3:   log likelihood =  -3.470496
Iteration 4:   log likelihood = -3.4557817
Iteration 5:   log likelihood = -3.4504301
Iteration 6:   log likelihood = -3.4484694
Iteration 7:   log likelihood = -3.4477492
Iteration 8:   log likelihood = -3.4474844
Iteration 9:   log likelihood =  -3.447387
Iteration 10:  log likelihood = -3.4473511
Iteration 11:  log likelihood =  -3.447338
Iteration 12:  log likelihood = -3.4473331
Iteration 13:  log likelihood = -3.4473313
Iteration 14:  log likelihood = -3.4473307
Iteration 15:  log likelihood = -3.4473304
Iteration 16:  log likelihood = -3.4473304
Iteration 17:  log likelihood = -3.4473303
Iteration 18:  log likelihood = -3.4473303
Iteration 19:  log likelihood = -3.4473303
Iteration 20:  log likelihood = -3.4473303
Iteration 21:  log likelihood = -3.4473303
Iteration 22:  log likelihood = -3.4473303
Iteration 23:  log likelihood = -3.4473303
Iteration 24:  log likelihood = -3.4473303
Iteration 25:  log likelihood = -3.4473303
Iteration 26:  log likelihood = -3.4473303
Iteration 27:  log likelihood = -3.4473303
Iteration 28:  log likelihood = -3.4473303
Iteration 29:  log likelihood = -3.4473303
Iteration 30:  log likelihood = -3.4473303
Iteration 31:  log likelihood = -3.4473303
Iteration 32:  log likelihood = -3.4473303
Iteration 33:  log likelihood = -3.4473303
Iteration 34:  log likelihood = -3.4473303
Refining estimates:
Iteration 0:   log likelihood = -3.4473303
Iteration 1:   log likelihood = -3.4473303

Stratified Cox regr. -- no ties

No. of subjects =        1,000                  Number of obs    =          50
No. of failures =           68
Time at risk    =       725652
                                                LR chi2(3)       =        3.94
Log likelihood  =   -3.4473303                  Prob > chi2      =      0.2683

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   8.94e-07    121.059    -0.00   1.000            0           .
      Black  |   9.06e-07   72.69886    -0.00   1.000            0           .
      Mixed  |   1.19e+10   1.82e+10    15.16   0.000     5.91e+08    2.38e+11
      Other  |   8.84e+09          .        .       .            .           .
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/crude_dm_eth.ster not found)
file ./output/tempdata/crude_dm_eth.ster saved
(note: file ./output/tempdata/surv_crude_dm_eth.dta not found)
file ./output/tempdata/surv_crude_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: 3.age_cat omitted because of collinearity
Iteration 0:   log likelihood = -3.0445224
Iteration 1:   log likelihood = -.74792132
Iteration 2:   log likelihood = -.71346628
Iteration 3:   log likelihood = -.70065845
Iteration 4:   log likelihood = -.69591615
Iteration 5:   log likelihood = -.69416665
Iteration 6:   log likelihood = -.69352234
Iteration 7:   log likelihood = -.69328521
Iteration 8:   log likelihood = -.69319796
Iteration 9:   log likelihood = -.69316586
Iteration 10:  log likelihood = -.69315405
Iteration 11:  log likelihood = -.69314971
Iteration 12:  log likelihood = -.69314811
Iteration 13:  log likelihood = -.69314752
Iteration 14:  log likelihood = -.69314731
Iteration 15:  log likelihood = -.69314723
Iteration 16:  log likelihood =  -.6931472
Iteration 17:  log likelihood = -.69314719
Iteration 18:  log likelihood = -.69314718
Iteration 19:  log likelihood = -.69314718
Iteration 20:  log likelihood = -.69314718
Iteration 21:  log likelihood = -.69314718
Iteration 22:  log likelihood = -.69314718
Iteration 23:  log likelihood = -.69314718
Iteration 24:  log likelihood = -.69314718
Iteration 25:  log likelihood = -.69314718
Iteration 26:  log likelihood = -.69314718
Iteration 27:  log likelihood = -.69314718
Iteration 28:  log likelihood = -.69314718
Iteration 29:  log likelihood = -.69314718
Iteration 30:  log likelihood = -.69314718
Iteration 31:  log likelihood = -.69314718
Iteration 32:  log likelihood = -.69314718
Refining estimates:
Iteration 0:   log likelihood = -.69314718
Iteration 1:   log likelihood = -.69314718

Stratified Cox regr. -- no ties

No. of subjects =          784                  Number of obs    =          40
No. of failures =           50
Time at risk    =       569261
                                                LR chi2(7)       =        4.70
Log likelihood  =   -.69314718                  Prob > chi2      =      0.6962

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   4.74e+13   3.08e+22     0.00   1.000            0           .
      Black  |   .1540578   8.39e+07    -0.00   1.000            0           .
      Mixed  |   7.32e+14   4.79e+23     0.00   1.000            0           .
      Other  |   6.57e+13   4.55e+22     0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |    2.79767   3.49e+08     0.00   1.000            0           .
61 - 80 y..  |   5.06e+15   5.47e+23     0.00   1.000            0           .
  >80 years  |          1  (omitted)
             |
        male |
       Male  |   .2895759   1.51e+08    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/model1_dm_eth.ster not found)
file ./output/tempdata/model1_dm_eth.ster saved
(note: file ./output/tempdata/surv_model1_dm_eth.dta not found)
file ./output/tempdata/surv_model1_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: 3.age_cat omitted because of collinearity
Iteration 0:   log likelihood = -3.0445224
Iteration 1:   log likelihood =  -.0040852
Iteration 2:   log likelihood = -.00149925
Iteration 3:   log likelihood = -.00055109
Iteration 4:   log likelihood = -.00020269
Iteration 5:   log likelihood = -.00007456
Iteration 6:   log likelihood = -.00002743
Iteration 7:   log likelihood = -.00001009
Iteration 8:   log likelihood = -3.713e-06
Iteration 9:   log likelihood = -1.366e-06
Iteration 10:  log likelihood = -5.025e-07
Iteration 11:  log likelihood = -1.849e-07
Iteration 12:  log likelihood = -6.801e-08
Iteration 13:  log likelihood = -2.502e-08
Iteration 14:  log likelihood = -9.204e-09
Iteration 15:  log likelihood = -3.386e-09
Iteration 16:  log likelihood = -1.246e-09
Iteration 17:  log likelihood = -4.583e-10
Iteration 18:  log likelihood = -1.686e-10
Iteration 19:  log likelihood = -6.202e-11
Iteration 20:  log likelihood = -2.282e-11
Iteration 21:  log likelihood = -8.395e-12
Iteration 22:  log likelihood = -3.091e-12
Iteration 23:  log likelihood = -1.137e-12
Iteration 24:  log likelihood = -4.192e-13
Iteration 25:  log likelihood = -1.563e-13
Iteration 26:  log likelihood = -5.684e-14
Iteration 27:  log likelihood = -3.553e-14
Iteration 28:  log likelihood = -1.421e-14
Iteration 29:  log likelihood = -7.105e-15
Iteration 30:  log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0
Iteration 1:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          784                  Number of obs    =          40
No. of failures =           50
Time at risk    =       569261
                                                LR chi2(10)      =        6.09
Log likelihood  =            0                  Prob > chi2      =      0.8077

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   436.2077   1.16e+12     0.00   1.000            0           .
      Black  |   72.47275   1.28e+11     0.00   1.000            0           .
      Mixed  |   1.85e+09   2.03e+17     0.00   1.000            0           .
      Other  |    .007538   1.74e+07    -0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |   725.5795   1.88e+12     0.00   1.000            0           .
61 - 80 y..  |   .7152987          .        .       .            .           .
  >80 years  |          1  (omitted)
             |
        male |
       Male  |   1.94e-08   49.48708    -0.00   1.000            0           .
             |
urban_rura~n |
      Urban  |   1.75e+15   7.06e+22     0.00   1.000            0           .
             |
         imd |
          1  |    .000032          .        .       .            .           .
          2  |   3.21e+12   7.08e+21     0.00   1.000            0           .
          3  |   8.50e-08   191.4161    -0.00   1.000            0           .
          4  |   .1124494          .        .       .            .           .
          5  |   6.52e-08   143.4556    -0.00   1.000            0           .
             |
  1.shielded |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
(note: file ./output/tempdata/model2_dm_eth.ster not found)
file ./output/tempdata/model2_dm_eth.ster saved
(note: file ./output/tempdata/surv_model2_dm_eth.dta not found)
file ./output/tempdata/surv_model2_dm_eth.dta saved
(note: file ./output/tables/dm_estout_table_eth_pre.txt not found)
(output written to ./output/tables/dm_estout_table_eth_pre.txt)
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        932       93.20       93.20
          1 |         68        6.80      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  68
(68 real changes made)

                id:  patient_id
     failure event:  dm_admit != 0 & dm_admit < .
obs. time interval:  (dm_end[_n-1], dm_end]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,000  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,000  observations remaining, representing
      1,000  subjects
         68  failures in single-failure-per-subject data
    705,500  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       768

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_dm_pandemic_eth.svg not found)
(file ./output/graphs/km_dm_pandemic_eth.svg written in SVG format)

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -8.8603573
Iteration 1:   log likelihood = -6.9099368
Iteration 2:   log likelihood = -6.5320267
Iteration 3:   log likelihood = -6.4399444
Iteration 4:   log likelihood = -6.4226801
Iteration 5:   log likelihood = -6.4164033
Iteration 6:   log likelihood = -6.4141024
Iteration 7:   log likelihood =  -6.413257
Iteration 8:   log likelihood = -6.4129462
Iteration 9:   log likelihood = -6.4128318
Iteration 10:  log likelihood = -6.4127898
Iteration 11:  log likelihood = -6.4127743
Iteration 12:  log likelihood = -6.4127686
Iteration 13:  log likelihood = -6.4127665
Iteration 14:  log likelihood = -6.4127657
Iteration 15:  log likelihood = -6.4127655
Iteration 16:  log likelihood = -6.4127654
Iteration 17:  log likelihood = -6.4127653
Iteration 18:  log likelihood = -6.4127653
Iteration 19:  log likelihood = -6.4127653
Iteration 20:  log likelihood = -6.4127653
Iteration 21:  log likelihood = -6.4127653
Iteration 22:  log likelihood = -6.4127653
Iteration 23:  log likelihood = -6.4127653
Iteration 24:  log likelihood = -6.4127653
Iteration 25:  log likelihood = -6.4127653
Iteration 26:  log likelihood = -6.4127653
Iteration 27:  log likelihood = -6.4127653
Iteration 28:  log likelihood = -6.4127653
Iteration 29:  log likelihood = -6.4127653
Iteration 30:  log likelihood = -6.4127653
Iteration 31:  log likelihood = -6.4127653
Iteration 32:  log likelihood = -6.4127653
Iteration 33:  log likelihood = -6.4127653
Iteration 34:  log likelihood = -6.4127653
Iteration 35:  log likelihood = -6.4127653
Refining estimates:
Iteration 0:   log likelihood = -6.4127653
Iteration 1:   log likelihood = -6.4127653
Iteration 2:   log likelihood = -6.4127653

Stratified Cox regr. -- no ties

No. of subjects =        1,000                  Number of obs    =          50
No. of failures =           68
Time at risk    =       705500
                                                LR chi2(4)       =        4.90
Log likelihood  =   -6.4127653                  Prob > chi2      =      0.2982

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   7.11e-18   1.40e-09    -0.00   1.000            0           .
      Black  |   .7672972   1.207765    -0.17   0.866     .0350856    16.78023
      Mixed  |   8.71e-18   1.94e-09    -0.00   1.000            0           .
      Other  |   .2712805   .4320572    -0.82   0.413     .0119604    6.153071
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_dm_eth.ster saved
file ./output/tempdata/surv_crude_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -6.4361504
Iteration 1:   log likelihood =  -3.696909
Iteration 2:   log likelihood = -.51245893
Iteration 3:   log likelihood = -.12670216
Iteration 4:   log likelihood = -.04352984
Iteration 5:   log likelihood = -.01568234
Iteration 6:   log likelihood = -.00572788
Iteration 7:   log likelihood = -.00210174
Iteration 8:   log likelihood = -.00077246
Iteration 9:   log likelihood = -.00028407
Iteration 10:  log likelihood = -.00010449
Iteration 11:  log likelihood = -.00003844
Iteration 12:  log likelihood = -.00001414
Iteration 13:  log likelihood = -5.202e-06
Iteration 14:  log likelihood = -1.913e-06
Iteration 15:  log likelihood = -7.043e-07
Iteration 16:  log likelihood = -2.574e-07
Iteration 17:  log likelihood = -9.979e-08
Iteration 18:  log likelihood = -4.313e-08
Iteration 19:  log likelihood = -1.207e-08
Iteration 20:  log likelihood =  3.006e-08
Iteration 21:  log likelihood =  3.006e-08  (backed up)
Refining estimates:
Iteration 0:   log likelihood = -1.183e-07
Iteration 1:   log likelihood = -4.353e-08
Iteration 2:   log likelihood = -1.602e-08
Iteration 3:   log likelihood = -5.892e-09
Iteration 4:   log likelihood = -2.167e-09
Iteration 5:   log likelihood = -7.974e-10
Iteration 6:   log likelihood = -2.933e-10
Iteration 7:   log likelihood = -1.079e-10
Iteration 8:   log likelihood = -3.970e-11
Iteration 9:   log likelihood = -1.460e-11
Iteration 10:  log likelihood = -5.375e-12
Iteration 11:  log likelihood = -1.975e-12
Iteration 12:  log likelihood = -7.248e-13
Iteration 13:  log likelihood = -2.665e-13
Iteration 14:  log likelihood = -9.948e-14
Iteration 15:  log likelihood = -3.553e-14
Iteration 16:  log likelihood = -1.421e-14
Iteration 17:  log likelihood = -1.421e-14

Stratified Cox regr. -- no ties

No. of subjects =          786                  Number of obs    =          42
No. of failures =           45
Time at risk    =       555822
                                                LR chi2(6)       =       12.87
Log likelihood  =   -1.421e-14                  Prob > chi2      =      0.0451

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   5.04e-37   2.98e-28    -0.00   1.000            0           .
      Black  |   1.77e-19   2.14e-12    -0.00   1.000            0           .
      Mixed  |   3.05e-37   2.32e-28    -0.00   1.000            0           .
      Other  |   1.21e-33          .        .       .            .           .
             |
     age_cat |
41 - 60 y..  |   7.23e+32   1.19e+40     0.00   1.000            0           .
61 - 80 y..  |   .0260758    1848332    -0.00   1.000            0           .
  >80 years  |   8.11e+28          .        .       .            .           .
             |
        male |
       Male  |   2.30e-36   6.38e-28    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model1_dm_eth.ster saved
file ./output/tempdata/surv_model1_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -6.4361504
Iteration 1:   log likelihood = -.00582831
Iteration 2:   log likelihood = -.00214939
Iteration 3:   log likelihood = -.00079202
Iteration 4:   log likelihood = -.00029168
Iteration 5:   log likelihood = -.00010738
Iteration 6:   log likelihood = -.00003952
Iteration 7:   log likelihood = -.00001454
Iteration 8:   log likelihood = -5.352e-06
Iteration 9:   log likelihood = -1.970e-06
Iteration 10:  log likelihood = -7.248e-07
Iteration 11:  log likelihood = -2.678e-07
Iteration 12:  log likelihood = -9.604e-08
Iteration 13:  log likelihood = -3.536e-08
Iteration 14:  log likelihood = -3.042e-08  (backed up)
Iteration 15:  log likelihood = -2.661e-08  (backed up)
Iteration 16:  log likelihood = -2.163e-08
Iteration 17:  log likelihood =  5.330e-06
Iteration 18:  log likelihood =  5.330e-06
Refining estimates:
Iteration 0:   log likelihood = -1.663e-08
Iteration 1:   log likelihood = -6.117e-09
Iteration 2:   log likelihood = -2.250e-09
Iteration 3:   log likelihood = -8.278e-10
Iteration 4:   log likelihood = -3.045e-10
Iteration 5:   log likelihood = -1.120e-10
Iteration 6:   log likelihood = -4.122e-11
Iteration 7:   log likelihood = -1.517e-11
Iteration 8:   log likelihood = -5.578e-12
Iteration 9:   log likelihood = -2.053e-12
Iteration 10:  log likelihood = -7.532e-13
Iteration 11:  log likelihood = -2.771e-13
Iteration 12:  log likelihood = -9.948e-14
Iteration 13:  log likelihood = -3.553e-14
Iteration 14:  log likelihood = -3.553e-14

Stratified Cox regr. -- no ties

No. of subjects =          786                  Number of obs    =          42
No. of failures =           45
Time at risk    =       555822
                                                LR chi2(13)      =       12.87
Log likelihood  =   -3.553e-14                  Prob > chi2      =      0.4577

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   2.75e-14          .        .       .            .           .
      Black  |   141620.2   1.67e+13     0.00   1.000            0           .
      Mixed  |   1.53e-15   2.90e-07    -0.00   1.000            0           .
      Other  |   2.20e-10   .0254882    -0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |   4.09e+08   6.28e+16     0.00   1.000            0           .
61 - 80 y..  |   1.85e-15   3.45e-07    -0.00   1.000            0           .
  >80 years  |   1.56e+12   4.04e+20     0.00   1.000            0           .
             |
        male |
       Male  |    .001359     261545    -0.00   1.000            0           .
             |
urban_rura~n |
      Urban  |   1.08e+15   2.36e+23     0.00   1.000            0           .
             |
         imd |
          1  |   3.09e+19   6.33e+27     0.00   1.000            0           .
          2  |   1.98e+09          .        .       .            .           .
          3  |   8.03e+10   4.99e+18     0.00   1.000            0           .
          4  |   2.38e+09   1.75e+17     0.00   1.000            0           .
          5  |    9439.65   1.08e+12     0.00   1.000            0           .
             |
  1.shielded |   4.38e+08   1.12e+17     0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model2_dm_eth.ster saved
file ./output/tempdata/surv_model2_dm_eth.dta saved
(note: file ./output/tables/dm_estout_table_eth_pandemic.txt not found)
(output written to ./output/tables/dm_estout_table_eth_pandemic.txt)
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        993       99.30       99.30
          1 |          7        0.70      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  7
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        995       99.50       99.50
          1 |          5        0.50      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  5
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        981       98.10       98.10
          1 |         19        1.90      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  19
(19 real changes made)

                id:  patient_id
     failure event:  dm_admit != 0 & dm_admit < .
obs. time interval:  (dm_end[_n-1], dm_end]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,000  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,000  observations remaining, representing
      1,000  subjects
         19  failures in single-failure-per-subject data
    223,219  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       229

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_dm_wave2_eth.svg not found)
(file ./output/graphs/km_dm_wave2_eth.svg written in SVG format)

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =        1,000                  Number of obs    =          50
No. of failures =           19
Time at risk    =       223219
                                                LR chi2(0)       =        0.00
Log likelihood  =            0                  Prob > chi2      =           .

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |          1  (omitted)
      Black  |          1  (omitted)
      Mixed  |          1  (omitted)
      Other  |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_dm_eth.ster saved
file ./output/tempdata/surv_crude_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          749                  Number of obs    =          36
No. of failures =           14
Time at risk    =       166380
                                                LR chi2(0)       =        0.00
Log likelihood  =            0                  Prob > chi2      =           .

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |          1  (omitted)
      Black  |          1  (omitted)
      Mixed  |          1  (omitted)
      Other  |          1  (omitted)
             |
     age_cat |
41 - 60 y..  |          1  (omitted)
61 - 80 y..  |          1  (omitted)
  >80 years  |          1  (omitted)
             |
        male |
       Male  |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model1_dm_eth.ster saved
file ./output/tempdata/surv_model1_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: 1.shielded omitted because of collinearity
Iteration 0:   log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          749                  Number of obs    =          36
No. of failures =           14
Time at risk    =       166380
                                                LR chi2(0)       =        0.00
Log likelihood  =            0                  Prob > chi2      =           .

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |          1  (omitted)
      Black  |          1  (omitted)
      Mixed  |          1  (omitted)
      Other  |          1  (omitted)
             |
     age_cat |
41 - 60 y..  |          1  (omitted)
61 - 80 y..  |          1  (omitted)
  >80 years  |          1  (omitted)
             |
        male |
       Male  |          1  (omitted)
             |
urban_rura~n |
      Urban  |          1  (omitted)
             |
         imd |
          1  |          1  (omitted)
          2  |          1  (omitted)
          3  |          1  (omitted)
          4  |          1  (omitted)
          5  |          1  (omitted)
             |
  1.shielded |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model2_dm_eth.ster saved
file ./output/tempdata/surv_model2_dm_eth.dta saved
(note: file ./output/tables/dm_estout_table_eth_wave2.txt not found)
(output written to ./output/tables/dm_estout_table_eth_wave2.txt)
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        997       99.70       99.70
          1 |          3        0.30      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  3
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        979       97.90       97.90
          1 |         21        2.10      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  21
(21 real changes made)

                id:  patient_id
     failure event:  dm_admit != 0 & dm_admit < .
obs. time interval:  (dm_end[_n-1], dm_end]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,000  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,000  observations remaining, representing
      1,000  subjects
         21  failures in single-failure-per-subject data
    194,866  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       200

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_dm_wave3_eth.svg not found)
(file ./output/graphs/km_dm_wave3_eth.svg written in SVG format)

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -5.1059455
Iteration 1:   log likelihood = -3.9574828
Iteration 2:   log likelihood = -2.9496127
Iteration 3:   log likelihood = -2.5082079
Iteration 4:   log likelihood = -2.2978382
Iteration 5:   log likelihood = -2.2925106
Iteration 6:   log likelihood = -2.2924607
Iteration 7:   log likelihood = -2.2924423
Iteration 8:   log likelihood = -2.2924356
Iteration 9:   log likelihood = -2.2924331
Iteration 10:  log likelihood = -2.2924322
Iteration 11:  log likelihood = -2.2924319
Iteration 12:  log likelihood = -2.2924317
Iteration 13:  log likelihood = -2.2924317
Iteration 14:  log likelihood = -2.2924317
Iteration 15:  log likelihood = -2.2924317
Iteration 16:  log likelihood = -2.2924317
Iteration 17:  log likelihood = -2.2924317
Iteration 18:  log likelihood = -2.2924317
Iteration 19:  log likelihood = -2.2924317
Iteration 20:  log likelihood = -2.2924317
Iteration 21:  log likelihood = -2.2924317
Iteration 22:  log likelihood = -2.2924317
Iteration 23:  log likelihood = -2.2924317
Iteration 24:  log likelihood = -2.2924317
Iteration 25:  log likelihood = -2.2924317
Iteration 26:  log likelihood = -2.2924317
Iteration 27:  log likelihood = -2.2924317
Iteration 28:  log likelihood = -2.2924317
Iteration 29:  log likelihood = -2.2924317
Iteration 30:  log likelihood = -2.2924317
Iteration 31:  log likelihood = -2.2924317
Refining estimates:
Iteration 0:   log likelihood = -2.2924317
Iteration 1:   log likelihood = -2.2924317

Stratified Cox regr. -- no ties

No. of subjects =        1,000                  Number of obs    =          50
No. of failures =           21
Time at risk    =       194866
                                                LR chi2(3)       =        5.63
Log likelihood  =   -2.2924317                  Prob > chi2      =      0.1312

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   2.13e+10   3.02e+10    16.73   0.000     1.31e+09    3.45e+11
      Black  |   8.68e+09          .        .       .            .           .
      Mixed  |   2.40e-07   48.11564    -0.00   1.000            0           .
      Other  |   3.86e-07   45.89253    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_dm_eth.ster saved
file ./output/tempdata/surv_crude_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -2.3978953
Iteration 1:   log likelihood =   -.000167
Iteration 2:   log likelihood = -.00006143
Iteration 3:   log likelihood =  -.0000226
Iteration 4:   log likelihood = -8.313e-06
Iteration 5:   log likelihood = -3.058e-06
Iteration 6:   log likelihood = -1.125e-06
Iteration 7:   log likelihood = -4.139e-07
Iteration 8:   log likelihood = -1.523e-07
Iteration 9:   log likelihood = -5.601e-08
Iteration 10:  log likelihood = -2.061e-08
Iteration 11:  log likelihood = -7.581e-09
Iteration 12:  log likelihood = -2.789e-09
Iteration 13:  log likelihood = -1.026e-09
Iteration 14:  log likelihood = -3.774e-10
Iteration 15:  log likelihood = -1.388e-10
Iteration 16:  log likelihood = -5.108e-11
Iteration 17:  log likelihood = -1.879e-11
Iteration 18:  log likelihood = -6.914e-12
Iteration 19:  log likelihood = -2.544e-12
Iteration 20:  log likelihood = -9.344e-13
Iteration 21:  log likelihood = -3.446e-13
Iteration 22:  log likelihood = -1.279e-13
Iteration 23:  log likelihood = -4.974e-14
Iteration 24:  log likelihood = -1.421e-14
Iteration 25:  log likelihood = -7.105e-15
Iteration 26:  log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0
Iteration 1:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          785                  Number of obs    =          39
No. of failures =           16
Time at risk    =       152616
                                                LR chi2(7)       =        4.80
Log likelihood  =            0                  Prob > chi2      =      0.6849

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   1.32e+14   1.08e+22     0.00   1.000            0           .
      Black  |   1.020371   1.07e+08     0.00   1.000            0           .
      Mixed  |   1.005108   1.47e+08     0.00   1.000            0           .
      Other  |   1.017796   8.92e+07     0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |   1.020371   1.07e+08     0.00   1.000            0           .
61 - 80 y..  |   1.017796   8.92e+07     0.00   1.000            0           .
  >80 years  |    91.5041          .        .       .            .           .
             |
        male |
       Male  |   1.007535   8.26e+07     0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model1_dm_eth.ster saved
file ./output/tempdata/surv_model1_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: 1.shielded omitted because of collinearity
Iteration 0:   log likelihood = -2.3978953
Iteration 1:   log likelihood =   -.000167
Iteration 2:   log likelihood = -.00006143
Iteration 3:   log likelihood =  -.0000226
Iteration 4:   log likelihood = -8.313e-06
Iteration 5:   log likelihood = -3.058e-06
Iteration 6:   log likelihood = -1.125e-06
Iteration 7:   log likelihood = -4.139e-07
Iteration 8:   log likelihood = -1.523e-07
Iteration 9:   log likelihood = -5.601e-08
Iteration 10:  log likelihood = -2.061e-08
Iteration 11:  log likelihood = -7.581e-09
Iteration 12:  log likelihood = -2.789e-09
Iteration 13:  log likelihood = -1.026e-09
Iteration 14:  log likelihood = -3.774e-10
Iteration 15:  log likelihood = -1.388e-10
Iteration 16:  log likelihood = -5.108e-11
Iteration 17:  log likelihood = -1.879e-11
Iteration 18:  log likelihood = -6.914e-12
Iteration 19:  log likelihood = -2.544e-12
Iteration 20:  log likelihood = -9.344e-13
Iteration 21:  log likelihood = -3.446e-13
Iteration 22:  log likelihood = -1.279e-13
Iteration 23:  log likelihood = -4.974e-14
Iteration 24:  log likelihood = -1.421e-14
Iteration 25:  log likelihood = -7.105e-15
Iteration 26:  log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0
Iteration 1:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          785                  Number of obs    =          39
No. of failures =           16
Time at risk    =       152616
                                                LR chi2(12)      =        4.80
Log likelihood  =            0                  Prob > chi2      =      0.9645

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   9.54e+08   1.16e+17     0.00   1.000            0           .
      Black  |   .3790616          .        .       .            .           .
      Mixed  |   .3682603   7.97e+07    -0.00   1.000            0           .
      Other  |   .4032665   8.80e+07    -0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |   .8835593   3.36e+08    -0.00   1.000            0           .
61 - 80 y..  |          1   1.53e+08    -0.00   1.000            0           .
  >80 years  |    4691691   5.68e+14     0.00   1.000            0           .
             |
        male |
       Male  |   1.071571   1.67e+08     0.00   1.000            0           .
             |
urban_rura~n |
      Urban  |   1.148264   5.32e+08     0.00   1.000            0           .
             |
         imd |
          1  |          1  (omitted)
          2  |   1436.684   3.17e+11     0.00   1.000            0           .
          3  |   3790.107   4.27e+11     0.00   1.000            0           .
          4  |   3588.455   9.68e+11     0.00   1.000            0           .
          5  |   1350.452   2.17e+11     0.00   1.000            0           .
             |
  1.shielded |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model2_dm_eth.ster saved
file ./output/tempdata/surv_model2_dm_eth.dta saved
(note: file ./output/tables/dm_estout_table_eth_wave3.txt not found)
(output written to ./output/tables/dm_estout_table_eth_wave3.txt)
(0 observations deleted)

   dm_admit |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        986       98.60       98.60
          1 |         14        1.40      100.00
------------+-----------------------------------
      Total |      1,000      100.00
  14
(14 real changes made)

                id:  patient_id
     failure event:  dm_admit != 0 & dm_admit < .
obs. time interval:  (dm_end[_n-1], dm_end]
 enter on or after:  time index_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time index_date

------------------------------------------------------------------------------
      1,000  total observations
          0  exclusions
------------------------------------------------------------------------------
      1,000  observations remaining, representing
      1,000  subjects
         14  failures in single-failure-per-subject data
    134,307  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       136

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id
(note: file ./output/graphs/km_dm_easing3_eth.svg not found)
(file ./output/graphs/km_dm_easing3_eth.svg written in SVG format)

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -3.3322045
Iteration 1:   log likelihood =  -1.626305
Iteration 2:   log likelihood = -1.6155712
Iteration 3:   log likelihood = -1.6116848
Iteration 4:   log likelihood = -1.6102632
Iteration 5:   log likelihood = -1.6097414
Iteration 6:   log likelihood = -1.6095495
Iteration 7:   log likelihood =  -1.609479
Iteration 8:   log likelihood =  -1.609453
Iteration 9:   log likelihood = -1.6094435
Iteration 10:  log likelihood =   -1.60944
Iteration 11:  log likelihood = -1.6094387
Iteration 12:  log likelihood = -1.6094382
Iteration 13:  log likelihood =  -1.609438
Iteration 14:  log likelihood = -1.6094379
Iteration 15:  log likelihood = -1.6094379
Iteration 16:  log likelihood = -1.6094379
Iteration 17:  log likelihood = -1.6094379
Iteration 18:  log likelihood = -1.6094379
Iteration 19:  log likelihood = -1.6094379
Iteration 20:  log likelihood = -1.6094379
Iteration 21:  log likelihood = -1.6094379
Iteration 22:  log likelihood = -1.6094379
Iteration 23:  log likelihood = -1.6094379
Iteration 24:  log likelihood = -1.6094379
Iteration 25:  log likelihood = -1.6094379
Iteration 26:  log likelihood = -1.6094379
Iteration 27:  log likelihood = -1.6094379
Iteration 28:  log likelihood = -1.6094379
Iteration 29:  log likelihood = -1.6094379
Iteration 30:  log likelihood = -1.6094379
Iteration 31:  log likelihood = -1.6094379
Refining estimates:
Iteration 0:   log likelihood = -1.6094379
Iteration 1:   log likelihood = -1.6094379

Stratified Cox regr. -- no ties

No. of subjects =        1,000                  Number of obs    =          50
No. of failures =           14
Time at risk    =       134307
                                                LR chi2(4)       =        3.45
Log likelihood  =   -1.6094379                  Prob > chi2      =      0.4862

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   8.07e+15   7.73e+23     0.00   1.000            0           .
      Black  |          1   1.31e+08    -0.00   1.000            0           .
      Mixed  |          1   1.17e+08    -0.00   1.000            0           .
      Other  |          1   1.39e+08    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/crude_dm_eth.ster saved
file ./output/tempdata/surv_crude_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

Iteration 0:   log likelihood = -3.2580965
Iteration 1:   log likelihood = -.00226462
Iteration 2:   log likelihood =  -.0008326
Iteration 3:   log likelihood = -.00030633
Iteration 4:   log likelihood = -.00011272
Iteration 5:   log likelihood = -.00004148
Iteration 6:   log likelihood = -.00001526
Iteration 7:   log likelihood = -5.616e-06
Iteration 8:   log likelihood = -2.066e-06
Iteration 9:   log likelihood = -7.602e-07
Iteration 10:  log likelihood = -2.797e-07
Iteration 11:  log likelihood = -1.029e-07
Iteration 12:  log likelihood = -3.785e-08
Iteration 13:  log likelihood = -1.393e-08
Iteration 14:  log likelihood = -5.123e-09
Iteration 15:  log likelihood = -1.885e-09
Iteration 16:  log likelihood = -6.934e-10
Iteration 17:  log likelihood = -2.551e-10
Iteration 18:  log likelihood = -9.384e-11
Iteration 19:  log likelihood = -3.452e-11
Iteration 20:  log likelihood = -1.270e-11
Iteration 21:  log likelihood = -4.672e-12
Iteration 22:  log likelihood = -1.720e-12
Iteration 23:  log likelihood = -6.324e-13
Iteration 24:  log likelihood = -2.345e-13
Iteration 25:  log likelihood = -8.527e-14
Iteration 26:  log likelihood = -2.842e-14
Iteration 27:  log likelihood = -1.421e-14
Iteration 28:  log likelihood = -7.105e-15
Iteration 29:  log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0
Iteration 1:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          787                  Number of obs    =          42
No. of failures =           12
Time at risk    =       105511
                                                LR chi2(7)       =        6.52
Log likelihood  =            0                  Prob > chi2      =      0.4809

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   7.66e+10   4.09e+18     0.00   1.000            0           .
      Black  |   .0000386          .        .       .            .           .
      Mixed  |   .0938441   1.51e+08    -0.00   1.000            0           .
      Other  |   1.97e-06   402.2124    -0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |   4.39e+07   6.33e+15     0.00   1.000            0           .
61 - 80 y..  |   2.478587   8.70e+08     0.00   1.000            0           .
  >80 years  |   2.39e-10   .1080259    -0.00   1.000            0           .
             |
        male |
       Male  |   3.19e-10   .0954132    -0.00   1.000            0           .
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model1_dm_eth.ster saved
file ./output/tempdata/surv_model1_dm_eth.dta saved

         failure _d:  dm_admit
   analysis time _t:  (dm_end-origin)
             origin:  time index_date
  enter on or after:  time index_date
                 id:  patient_id

note: 5.imd omitted because of collinearity
note: 1.shielded omitted because of collinearity
Iteration 0:   log likelihood = -3.2580965
Iteration 1:   log likelihood = -.00012456
Iteration 2:   log likelihood = -.00004585
Iteration 3:   log likelihood = -.00001687
Iteration 4:   log likelihood = -6.208e-06
Iteration 5:   log likelihood = -2.284e-06
Iteration 6:   log likelihood = -8.404e-07
Iteration 7:   log likelihood = -3.092e-07
Iteration 8:   log likelihood = -1.138e-07
Iteration 9:   log likelihood = -4.185e-08
Iteration 10:  log likelihood = -1.540e-08
Iteration 11:  log likelihood = -5.664e-09
Iteration 12:  log likelihood = -2.084e-09
Iteration 13:  log likelihood = -7.665e-10
Iteration 14:  log likelihood = -2.820e-10
Iteration 15:  log likelihood = -1.037e-10
Iteration 16:  log likelihood = -3.816e-11
Iteration 17:  log likelihood = -1.404e-11
Iteration 18:  log likelihood = -5.166e-12
Iteration 19:  log likelihood = -1.897e-12
Iteration 20:  log likelihood = -6.963e-13
Iteration 21:  log likelihood = -2.558e-13
Iteration 22:  log likelihood = -9.237e-14
Iteration 23:  log likelihood = -3.553e-14
Iteration 24:  log likelihood = -1.421e-14
Iteration 25:  log likelihood = -7.105e-15
Iteration 26:  log likelihood =          0
Refining estimates:
Iteration 0:   log likelihood =          0
Iteration 1:   log likelihood =          0

Stratified Cox regr. -- no ties

No. of subjects =          787                  Number of obs    =          42
No. of failures =           12
Time at risk    =       105511
                                                LR chi2(11)      =        6.52
Log likelihood  =            0                  Prob > chi2      =      0.8368

------------------------------------------------------------------------------
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        eth5 |
South Asian  |   7.38e+08   1.19e+17     0.00   1.000            0           .
      Black  |    .000016   2718.045    -0.00   1.000            0           .
      Mixed  |   1.28e-06   1241.297    -0.00   1.000            0           .
      Other  |   4.99e-07   142.5373    -0.00   1.000            0           .
             |
     age_cat |
41 - 60 y..  |   3.52e+08          .        .       .            .           .
61 - 80 y..  |   .0487654   2.02e+07    -0.00   1.000            0           .
  >80 years  |   5.99e-08   29.37365    -0.00   1.000            0           .
             |
        male |
       Male  |   9.01e-09   1.753494    -0.00   1.000            0           .
             |
urban_rura~n |
      Urban  |   36.98844   5.66e+09     0.00   1.000            0           .
             |
         imd |
          1  |   309571.3   5.97e+14     0.00   1.000            0           .
          2  |    4650856   5.90e+15     0.00   1.000            0           .
          3  |    4661992   3.67e+15     0.00   1.000            0           .
          4  |   .1675672          .        .       .            .           .
          5  |          1  (omitted)
             |
  1.shielded |          1  (omitted)
------------------------------------------------------------------------------
                                                             Stratified by stp
file ./output/tempdata/model2_dm_eth.ster saved
file ./output/tempdata/surv_model2_dm_eth.dta saved
(note: file ./output/tables/dm_estout_table_eth_easing3.txt not found)
(output written to ./output/tables/dm_estout_table_eth_easing3.txt)

. file close tablecontent

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/cox_model_dm.log
  log type:  text
 closed on:  18 Jul 2022, 15:36:50
-------------------------------------------------------------------------------
